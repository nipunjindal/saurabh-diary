<!DOCTYPE html>
<html>
<head>
    <title>Lawyer Diary</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        @font-face {
            font-family: 'krutidev10';
            src: url('krutidev10.ttf');
        }

        table {
            font-family: Arial, Helvetica, sans-serif;
            font-size: 22px;
            border-collapse: collapse;
            width: 100%;
        }

        td, th {
            border: 1px solid #ddd;
            padding: 8px;
            font-family: 'krutidev10', Arial, Helvetica, sans-serif;
        }

        th {
            padding-top: 12px;
            padding-bottom: 12px;
            text-align: left;
            background-color: #04AA6D;
            color: white;
        }

        tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        /* Add a new class for the "Next Date" cells */
        .no-font {
            font-family: Arial, Helvetica, sans-serif !important;
            font-size: 14px;
        }

        #searchContainer {
            text-align: center;
            margin: 20px 0;
        }

        #searchInput, #dateInput {
            font-size: 18px;
        }

        #searchButton {
            font-size: 18px;
        }

        #tableContainer {
            margin-top: 10px;
        }

        @media screen and (max-width: 600px) {
            /* Style the search input elements to stack vertically */
            #searchContainer {
                display: flex;
                flex-direction: column;
                align-items: center;
                margin: 10px 0;
            }

            #searchInput,
            #dateInput,
            #searchButton {
                width: 100%;
                margin-bottom: 10px;
            }

            /* Style the table to be full width */
            #csvTable {
                width: 100%;
            }
        }

    </style>
</head>
<body>
<div id="searchContainer">
    <input type="text" id="searchInput" placeholder="Search...">
    <input type="date" id="dateInput">
    <button id="searchButton">Search</button>
</div>
<div id="tableContainer">
    <table id="csvTable">
        <thead>
        <tr>
            <th>OSN NO</th>
            <th>Party</th>
            <th>Next Date</th>
        </tr>
        </thead>
        <tbody>
        </tbody>
    </table>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
<script>
    var data = [];
    // Path to CSV file
    var csvPath = 'data.csv';

    // Load CSV data from file
    fetch(csvPath)
        .then(response => response.text())
        .then(csvData => {
            // Parse CSV using Papa Parse and convert to array of objects
            Papa.parse(csvData, {
                header: true,
                complete: function (results) {
                    data = results.data;
                    // Convert date strings to date objects
                    data.forEach(function (obj) {
                        obj.Next_Date_Object = new Date(obj.Next_Date)
                    });
                    // Sort data by Next_Date_Object in ascending order
                    data.sort(function (a, b) {
                        return b.Next_Date_Object - a.Next_Date_Object;
                    });
                    renderTable(data); // Render table with all data
                }
            });
        })
        .catch(error => console.error(error));

    // Function to render table with given data
    function renderTable(data) {
        var tbody = document.querySelector('#csvTable tbody');
        tbody.innerHTML = ''; // Clear previous rows

        for (var i = 0; i < data.length; i++) {
            var row = document.createElement('tr');
            var osnNoCell = document.createElement('td');
            osnNoCell.innerHTML = data[i]['OSN_NO'];
            row.appendChild(osnNoCell);
            var partyNameCell = document.createElement('td');
            partyNameCell.innerHTML = data[i]['Party_Name'];
            row.appendChild(partyNameCell);
            var nextDateCell = document.createElement('td');
            // Convert the date object to the desired format
            var nextDate = data[i]['Next_Date_Object'];
            nextDateCell.innerHTML = nextDate.toLocaleDateString('en-GB', {
                day: 'numeric',
                month: 'short',
                year: '2-digit'
            });
            // Add the "no-font" class to the "Next Date" cells
            nextDateCell.classList.add("no-font");
            row.appendChild(nextDateCell);
            tbody.appendChild(row);
        }
    }

    // Search button event listener
    var searchButton = document.querySelector('#searchButton');
    searchInput.addEventListener('keydown', function (event) {
        if (event.keyCode === 13) { // Check if enter key was pressed
            searchButton.click(); // Trigger search button's click event
        }
    });
    searchButton.addEventListener('click', function () {
        var searchInput = document.querySelector('#searchInput');
        var searchText = searchInput.value.toLowerCase();
        var dateInput = document.querySelector('#dateInput');
        var selectedDate = dateInput.valueAsDate;
        var filteredData = data.filter(function (obj) {
            var values = Object.values(obj).join(' ').toLowerCase();
            var dateMatch = true;
            if (selectedDate) {
                var nextDate = obj.Next_Date_Object;
                // Set time values to zero for both dates
                nextDate.setHours(0, 0, 0, 0);
                selectedDate.setHours(0, 0, 0, 0);
                dateMatch = nextDate.getTime() === selectedDate.getTime();
            }
            return values.includes(searchText) && dateMatch;
        });
        renderTable(filteredData); // Render table with filtered data
    });
</script>
</body>
</html>
